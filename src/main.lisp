(in-package #:dino-lisp)

(defun game-main ()
  (sdl2:with-init (:everything)
    (sdl2:with-window (win :title "Dinodeck" :flags '(:shown) :w 800 :h 600)
      (sdl2:with-renderer (renderer win :flags '(:accelerated :targettexture :presentvsync))
	(sdl2-image:init '(:jpg :png))
	(let* ((sprite (make-sprite :texture (load-texture renderer "assets/mychar.png")
				    :source-rect (sdl2:make-rect 0 0 32 32)
				    :dest-rect (sdl2:make-rect 0 0 32 32))))
	  (sdl2:with-event-loop (:method :poll)
	    (:idle ()
		   (sdl2:render-clear renderer)
		   (sprite/render sprite renderer)
		   (sdl2:render-present renderer))
	    (:quit ()
		   (progn
		     (sprite/destroy-texture sprite)
		     t))))))))
